(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2711d0be"],{"171b":function(e,t,i){"use strict";i("994d")},"994d":function(e,t,i){},a55b:function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"pxy-login"},[e._m(0),t("div",{staticClass:"pxy-login-form"},[t("p",[e._v("登录")]),t("el-form",{ref:"ruleFormRef",attrs:{model:e.bindForm,rules:e.rules,"label-position":"top"}},[t("el-form-item",{attrs:{label:"用户",prop:"phone"}},[t("el-input",{staticClass:"phone-input",attrs:{type:"text",autocomplete:"off",placeholder:"请输入手机号"},on:{blur:e.getActivityAuth},model:{value:e.bindForm.phone,callback:function(t){e.$set(e.bindForm,"phone",t)},expression:"bindForm.phone"}})],1),t("el-form-item",{attrs:{label:"验证码",prop:"code"}},[t("el-row",{attrs:{type:"flex",justify:"space-between"}},[t("el-input",{staticClass:"code-input",attrs:{placeholder:"请输入验证码",clearable:!0},model:{value:e.bindForm.code,callback:function(t){e.$set(e.bindForm,"code",t)},expression:"bindForm.code"}}),t("el-button",{staticStyle:{color:"#32cdcd",border:"1px solid #32cdcd"},attrs:{disabled:!(60===e.captchaTime)||!e.allowPermission,plain:""},on:{click:e.getCaptchaCodeFn}},[e._v(e._s(e.captchaText))])],1),e.allowPermission?e._e():t("span",{staticClass:"primary-color",staticStyle:{"font-size":"14px","margin-top":"13px",display:"inline--block"}},[e._v("您尚未报名或未通过审核，无法进入会议，请联系主办方")])],1),t("el-form-item",[t("el-button",{staticClass:"login-btn",attrs:{disabled:!e.allowPermission,size:"large",type:"primary"},on:{click:function(t){return t.preventDefault(),e.loginFn.apply(null,arguments)}}},[e._v(" 立即登录 ")])],1),t("el-form-item",{staticStyle:{"text-align":"center"},attrs:{prop:"agreeValue"}},[t("el-checkbox",{model:{value:e.bindForm.agreeValue,callback:function(t){e.$set(e.bindForm,"agreeValue",t)},expression:"bindForm.agreeValue"}},[e._v("已阅读并同意"),t("span",{on:{click:e.toAgreement}},[e._v("《平行云元宇宙大会用户协议》")])])],1)],1)],1)])},s=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"pxy-login-title"},[t("p",[e._v("平行云境")]),t("p",[e._v("元宇宙活动平台")])])}],o=(i("d9e2"),i("ac34"));const a=(e,t,i)=>{t?/^1[3456789]\d{9}$/.test(t)?i():i(new Error("请输入正确的手机号")):i(new Error("请输入手机号"))},c=(e,t,i)=>{t?i():i(new Error("请阅读勾选该用户协议"))};var n={data(){return{ruleForm:{username:"",password:"",captchaValue:"",captchaId:"",agreeValue:!1},rules:{username:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],captchaValue:[{required:!0,message:"请输入验证码",trigger:"blur"}],agreeValue:[{required:!0,message:"请阅读勾选该用户协议",trigger:"blur change"},{validator:c,trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:a,trigger:"blur"}]},captchaUrl:"",bindForm:{phone:"",code:"",agreeValue:!0},captchaTime:60,captchaText:"获取验证码",allowPermission:!0}},methods:{getActivityAuth(){if(/^1[3456789]\d{9}$/.test(this.bindForm.phone)){const e={phone:this.bindForm.phone,code:this.$route.query.code||localStorage.getItem("activityCode")};Object(o["g"])(e).then(e=>{e&&1e3===e.code?this.allowPermission=!0:e&&430===e.code&&(this.allowPermission=!1)})}},toAgreement(){this.$router.push("/agreement")},loginFn(){if(!this.allowPermission)return;const e={...this.bindForm,activityCode:this.$route.query.code||localStorage.getItem("activityCode")};this.$refs.ruleFormRef.validate(t=>{t&&Object(o["j"])(e).then(e=>{if(1e3===e.code){const t=e.result;"管理员"===t.userTitle&&(this.$store.commit("setIsAdminAuth",!0),window.localStorage.setItem("isAdminAuth",!0)),window.localStorage.setItem("userInfo",JSON.stringify(t)),this.$store.commit("setUserInfo",JSON.stringify(t)),this.getMemberId(),this.$router.push("/appli/enter")}else this.$message.error(e.message)})})},getCaptchaCodeFn(){this.bindForm.phone?/^1[3456789]\d{9}$/.test(this.bindForm.phone)?Object(o["h"])({phone:this.bindForm.phone}).then(e=>{if(e&&1e3===e.code){this.$message.success("验证码发送成功"),this.captchaTime--,this.captchaText=this.captchaTime+"S后重新发送";const e=setInterval(()=>{this.captchaTime--,this.captchaText=this.captchaTime+"S后重新发送",0===this.captchaTime&&(clearInterval(e),this.captchaText="重新发送验证码",this.captchaTime=60)},1e3)}else this.$message.error(e.message)}):this.$message.error("请输入正确的手机号"):this.$message.error("请输入手机号")},async getMemberId(){const e={activityId:this.$store.state.activityId};await Object(o["z"])(e).then(e=>{1e3===e.code?(this.$store.commit("setMemberId",e.result),window.localStorage.setItem("memberId",e.result)):this.$message.error(e.message)})}},mounted(){const e=this.loginFn;document.onkeyup=function(t){const i=t.key;"Enter"===i&&e()},this.$route.query.activityId&&(this.$store.commit("setActivityId",this.$route.query.activityId),window.localStorage.setItem("activityId",this.$route.query.activityId)),this.$route.query.code&&window.localStorage.setItem("activityCode",this.$route.query.code),localStorage.getItem("isAdminAuth")&&(this.$store.commit("setIsAdminAuth",!1),localStorage.removeItem("isAdminAuth"))},destroyed(){document.onkeyup=null}},l=n,d=(i("171b"),i("2877")),m=Object(d["a"])(l,r,s,!1,null,"2851fd40",null);t["default"]=m.exports}}]);
//# sourceMappingURL=chunk-2711d0be.042ca250.js.map