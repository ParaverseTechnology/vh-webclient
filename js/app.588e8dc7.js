(function(e){function t(t){for(var o,a,i=t[0],l=t[1],s=t[2],d=0,f=[];d<i.length;d++)a=i[d],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&f.push(r[a][0]),r[a]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);u&&u(t);while(f.length)f.shift()();return c.push.apply(c,s||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],o=!0,i=1;i<n.length;i++){var l=n[i];0!==r[l]&&(o=!1)}o&&(c.splice(t--,1),e=a(a.s=n[0]))}return e}var o={},r={app:0},c=[];function a(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var s=0;s<i.length;s++)t(i[s]);var u=l;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"08f3":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("7a23"),r={ref:"appContainer"},c={key:0,class:"ui"},a={class:"chat"},i={class:"func"},l={class:"content"},s={key:0,class:"content-vm"},u={class:"content-text"},d={key:1,class:"content-user"},f={class:"content-text"},p={ref:"hiddenScroller",style:{height:"50px"}},h={class:"input"},b={class:"textInput"},v={class:"submit"},g={class:"controls"},O={class:"control-group"},m={class:"control-group"},y=Object(o["f"])("div",{class:"nav"},[Object(o["f"])("a",{href:"https://www.pingxingyun.com/"},[Object(o["f"])("button",null,"返回首页")])],-1);function j(e,t,n,j,k,C){var w=Object(o["m"])("font-awesome-icon");return Object(o["k"])(),Object(o["e"])("div",r,[k.showUi?(Object(o["k"])(),Object(o["e"])("div",c,[Object(o["f"])("div",a,[Object(o["f"])("div",i,[Object(o["g"])(w,{icon:["fas","trash"],size:"lg",onClick:C.clearContent},null,8,["onClick"])]),Object(o["f"])("div",l,[(Object(o["k"])(!0),Object(o["e"])(o["a"],null,Object(o["l"])(k.chatContent,(function(e,t){return Object(o["k"])(),Object(o["e"])("div",{key:t},["vm"==e.type?(Object(o["k"])(),Object(o["e"])("div",s,[Object(o["g"])(w,{icon:["fas","user-astronaut"],size:"2x"}),Object(o["f"])("div",u,Object(o["n"])(e.text),1)])):(Object(o["k"])(),Object(o["e"])("div",d,[Object(o["f"])("div",f,Object(o["n"])(e.text),1),Object(o["g"])(w,{icon:["fas","user-circle"],size:"2x"})]))])})),128)),Object(o["f"])("div",p,null,512)]),Object(o["f"])("div",h,[Object(o["f"])("div",{class:Object(o["j"])(C.recodeIconClass),onMousedown:t[0]||(t[0]=function(){return C.startRecode&&C.startRecode.apply(C,arguments)}),onMouseup:t[1]||(t[1]=function(){return C.stopRecode&&C.stopRecode.apply(C,arguments)}),onMouseleave:t[2]||(t[2]=function(){return C.stopRecode&&C.stopRecode.apply(C,arguments)})},[Object(o["g"])(w,{icon:["fas","microphone"],size:"3x"})],34),Object(o["f"])("div",b,[Object(o["q"])(Object(o["f"])("input",{"onUpdate:modelValue":t[3]||(t[3]=function(e){return k.inputValue=e}),onFocus:t[4]||(t[4]=function(){return C.onInputFocus&&C.onInputFocus.apply(C,arguments)}),onBlur:t[5]||(t[5]=function(){return C.onInputBlur&&C.onInputBlur.apply(C,arguments)}),placeholder:"hi,say something to me..."},null,544),[[o["o"],k.inputValue]])]),Object(o["f"])("div",v,[Object(o["f"])("button",{onClick:t[6]||(t[6]=function(){return C.sendText&&C.sendText.apply(C,arguments)})},"发送")])])]),Object(o["f"])("div",g,[Object(o["f"])("div",O,[Object(o["f"])("button",{onClick:t[7]||(t[7]=function(e){return C.changeZoom(0)})},"全身"),Object(o["f"])("button",{onClick:t[8]||(t[8]=function(e){return C.changeZoom(50)})},"半身"),Object(o["f"])("button",{onClick:t[9]||(t[9]=function(e){return C.changeZoom(100)})},"特写")]),Object(o["f"])("div",m,[Object(o["f"])("button",{onClick:t[10]||(t[10]=function(e){return C.changeBg(1)})},"背景1"),Object(o["f"])("button",{onClick:t[11]||(t[11]=function(e){return C.changeBg(2)})},"背景2"),Object(o["f"])("button",{onClick:t[12]||(t[12]=function(e){return C.changeBg(3)})},"背景3")])]),y])):Object(o["d"])("",!0)],512)}n("d3b7"),n("5cc6"),n("907a"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("e9c4");var k=n("e3d4"),C=n("6c03"),w={TextInput:1,CameraControl:2,ClientSize:3,Background:4},x={name:"App",components:{},data:function(){return{chatContent:[{type:"vm",text:"hello"}],larksr:null,inputValue:"",showUi:!1,recoder:null,recodeTimer:null}},computed:{recodeIconClass:function(){return null!==this.recoder?"recoding recoder":"recoder"}},methods:{startRecode:function(){var e=this;console.log("start recode"),this.recoder=new C["b"],this.recoder.start().then((function(){console.log("start recording"),e.sendRecoderBuffer(1),e.recodeTimeout(),e.userInput("recoding....")})).catch((function(e){console.log("Recording failed.",e)}))},stopRecode:function(){var e,t;(this.recodeTimer&&(window.clearInterval(this.recodeTimer),this.recodeTimer=null),this.recoder&&this.recoder.state==C["a"].RECORDING)&&(console.log("stop recode",this.recoder.state,this.recoder.ctx),this.sendRecoderBuffer(3),null===(e=this.recoder)||void 0===e||e.pause(),null===(t=this.recoder)||void 0===t||t.clear(),this.userInput("recoded"));this.recoder=null},pauseRecode:function(){var e;null===(e=this.recoder)||void 0===e||e.pause()},recodeTimeout:function(){var e=this;this.recodeTimer=setInterval((function(){console.log("recoder update..."),e.sendRecoderBuffer(2)}),1e3)},sendRecoderBuffer:function(e){var t=this;if(this.recoder&&this.recoder.state==C["a"].RECORDING){var n=this.recoder.getRecord({encodeTo:"wav",compressible:!0});console.log("send recode ",e,n,n.arrayBuffer());var o=new Blob([new Uint8Array([0,0,0,e]),n]);o.arrayBuffer().then((function(e){var n;console.log("send to datachannel buffers",e),null===(n=t.larksr)||void 0===n||n.sendBinaryToDataChannel(e)})).catch((function(e){console.warn("connect buffer failed",e)}))}},vmOutput:function(e){this.chatContent.push({type:"vm",text:e}),this.$refs.hiddenScroller.scrollIntoView({behavior:"smooth"})},userInput:function(e){this.chatContent.push({type:"user",text:e}),this.$refs.hiddenScroller.scrollIntoView({behavior:"smooth"})},clearContent:function(){this.chatContent=[]},onInputFocus:function(){var e;console.log("onInputFocus"),null===(e=this.larksr)||void 0===e||e.op.setKeyboardEnable(!1)},onInputBlur:function(){var e;console.log("onInputBlur"),null===(e=this.larksr)||void 0===e||e.op.setKeyboardEnable(!0)},sendText:function(){var e;this.inputValue?(null===(e=this.larksr)||void 0===e||e.sendTextToDataChannel(JSON.stringify({type:w.TextInput,data:this.inputValue})),this.userInput(this.inputValue),this.inputValue=""):console.log("input empty")},changeBg:function(e){var t;null===(t=this.larksr)||void 0===t||t.sendTextToDataChannel(JSON.stringify({type:w.Background,data:{backgound:e}}))},changeZoom:function(e){var t;null===(t=this.larksr)||void 0===t||t.sendTextToDataChannel(JSON.stringify({type:w.CameraControl,data:{align:0,zoom:e,angle:0}}))},clientSize:function(e,t){var n;null===(n=this.larksr)||void 0===n||n.sendTextToDataChannel(JSON.stringify({type:w.ClientSize,data:{platform:"win32",width:e,height:t,scale:1}}))}},mounted:function(){var e=this;Object(k["CreateLarkSRClientFromeAPI"])({rootElement:this.$refs["appContainer"],serverAddress:"http://222.128.6.137:8181/",authCode:"2ad9f9a6aa454a11df274e900613510b",scaleMode:"contain",fullScreenMode:0,loadingBgUrl:"https://home-obs.pingxingyun.com/homePage_4_0/bg.jpg"},{appliId:"814071627896586240"}).then((function(t){e.larksr=t,e.larksr.start(),e.larksr.on("connect",(function(e){console.log("LarkSRClientEvent CONNECT",e)})),e.larksr.on("gotremotesteam",(function(e){console.log("LarkSRClientEvent gotremotesteam",e)})),e.larksr.on("meidaloaded",(function(t){console.log("LarkSRClientEvent meidaloaded",t),e.showUi=!0})),e.larksr.on("mediaplaysuccess",(function(e){console.log("LarkSRClientEvent mediaplaysuccess",e)})),e.larksr.on("mediaplayfailed",(function(e){console.log("LarkSRClientEvent mediaplayfailed",e)})),e.larksr.on("meidaplaymute",(function(e){console.log("LarkSRClientEvent meidaplaymute",e)})),e.larksr.on("datachannelopen",(function(t){console.log("datachannel open",t),e.clientSize(e.larksr.screenState.viewPort.width,e.larksr.screenState.viewPort.height)})),e.larksr.on("datachanneltext",(function(t){if(t.data){var n;try{n=JSON.parse(t.data)}catch(o){return console.log("parse message failed.",t.data),void e.vmOutput(t.data)}if("number"!=typeof n)switch(n.type){case w.TextInput:e.vmOutput(n.data);break;default:console.log("unsupport data type",n);break}else e.vmOutput(t.data)}})),console.log("load appli success",t),e.larksr.on("error",(function(e){console.error("LarkSRClientEvent error",e),alert(JSON.stringify(e.message))})),e.larksr.on("info",(function(e){console.log("LarkSRClientEvent info",e)}))})).catch((function(e){console.log("load appli failed",e),alert(JSON.stringify(e))}))},beforeUnmount:function(){this.larksr.app.disConnect(),this.larksr=null}},S=(n("cf8d"),n("6b0d")),R=n.n(S);const I=R()(x,[["render",j]]);var T=I,B=(n("e6c6"),n("ecee")),E=n("c074"),N=n("ad3d");B["c"].add(E["c"],E["b"],E["a"],E["d"],E["f"],E["e"]),Object(o["c"])(T).component("font-awesome-icon",N["a"]).mount("#app")},cf8d:function(e,t,n){"use strict";n("08f3")},e6c6:function(e,t,n){}});
//# sourceMappingURL=app.588e8dc7.js.map